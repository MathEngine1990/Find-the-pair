<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <title>Find the Pair</title>
  <!-- ИСПРАВЛЕНО: Более точный viewport для мобильных -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" />
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <div id="game"></div>

  <!-- Локальный Phaser (важно: до сцен) -->
  <script src="lib/phaser.min.js"></script>

  <!-- Глобальные данные/тема и UI (важно: Buttons.js до сцен) -->
  <script src="ui/Theme.js"></script>
  <script src="game/Data.js"></script>
  <script src="ui/Button.js"></script>

  <!-- Быстрый чек: реально ли загрузился Buttons.js -->
  <script>
    console.log('Buttons loaded?', typeof window.makeImageButton);
    if (typeof window.makeImageButton !== 'function') {
      console.warn('ui/Buttons.js НЕ загрузился — возможно 404/неверный путь. Включаю временный стаб.');
      window.makeImageButton = function(scene,x,y,w,h,label,onClick){
        const t = scene.add.text(x,y,label,{fontFamily:'sans-serif',fontSize:'18px',color:'#fff'}).setOrigin(0.5);
        const z = scene.add.zone(x,y,w,h).setOrigin(0.5).setInteractive({useHandCursor:true});
        z.on('pointerdown',()=>onClick&&onClick());
        const c = scene.add.container(0,0,[t,z]); c.setSize(w,h); return c;
      };
      window.makeIconButton = function(scene,x,y,size,icon,onClick){
        return window.makeImageButton(scene,x,y,size,size,icon,onClick);
      };
    }
  </script>

  <!-- Сцены -->
  <script src="scenes/PreloadScene.js"></script>
  <script src="scenes/MenuScene.js"></script>
  <script src="scenes/GameScene.js"></script>

  <!-- ИСПРАВЛЕНО: Сверхвысокое разрешение для максимального качества -->
  <script>
    // Максимальный DPR для ультра-четкости
    const DPR = window.devicePixelRatio || 1;
    
    window.gameConfig = {
      type: Phaser.AUTO,
      parent: 'game',
      backgroundColor: '#1d2330',
      scale: {
        // FIT режим для лучшего качества
        mode: Phaser.Scale.FIT,
        autoCenter: Phaser.Scale.CENTER_BOTH,
        // ЗНАЧИТЕЛЬНО увеличенное базовое разрешение
        width: 2560,   // Увеличено с 1080 до 2560
        height: 1440   // Увеличено с 720 до 1440
      },
      resolution: DPR,
      render: { 
        antialias: true, 
        pixelArt: false,
        roundPixels: false, // Максимальная четкость
        powerPreference: 'high-performance',
        // ДОБАВЛЕНО: Дополнительные настройки качества
        premultipliedAlpha: true,
        transparent: false,
        clearBeforeRender: true
      },
      scene: [ window.PreloadScene, window.MenuScene, window.GameScene ],
      physics: {
        default: false
      },
      input: {
        activePointers: 1,
        smoothFactor: 0.1 // Небольшое сглаживание для плавности
      }
    };
  </script>

  <!-- VK bridge подгрузи в main-vk.js, если нужно, но не мешай запуску игры -->
  <!-- <script src="main-vk.js"></script> -->
  <script src="main.js"></script>
</body>
</html>