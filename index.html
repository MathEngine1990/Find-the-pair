<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <title>–ü–∞–º—è—Ç—å: –ù–∞–π–¥–∏ –ø–∞—Ä—É</title>
  <!-- –ö–†–ò–¢–ò–ß–ù–û: viewport –¥–ª—è –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞ -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, minimal-ui, viewport-fit=cover" />
    <!-- –ó–∞–ø—Ä–µ—Ç –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <!-- –ü–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π —Ä–µ–∂–∏–º -->
    <meta name="mobile-web-app-capable" content="yes" />

  
  <!-- –î–û–ë–ê–í–õ–ï–ù–û: Meta —Ç–µ–≥–∏ –¥–ª—è VK –∏ —Å–æ—Ü—Å–µ—Ç–µ–π -->
  <meta property="og:title" content="–ü–∞–º—è—Ç—å: –ù–∞–π–¥–∏ –ø–∞—Ä—É" />
  <meta property="og:description" content="–¢—Ä–µ–Ω–∏—Ä—É–π—Ç–µ –ø–∞–º—è—Ç—å, –Ω–∞—Ö–æ–¥—è –ø–∞—Ä–Ω—ã–µ –∫–∞—Ä—Ç—ã! –ò–≥—Ä–∞ —Å —Å–∏—Å—Ç–µ–º–æ–π –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π." />
  <meta property="og:image" content="https://mathengine1990.github.io/Find-the-pair/assets/icon-512.png" />
  <meta property="og:type" content="game" />
  <meta property="og:url" content="https://mathengine1990.github.io/Find-the-pair/" />
  
  <!-- –ò–°–ü–†–ê–í–õ–ï–ù–û: VK app_id –¥–æ–ª–∂–µ–Ω —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å vk-hosting-config.json -->
  <meta name="vk:app_id" content="53937545" />
  <meta name="theme-color" content="#1d2330" />
  
  <!-- –ò–°–ü–†–ê–í–õ–ï–ù–û: –£–±–∏—Ä–∞–µ–º preload –¥–ª—è back_card02.png —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å warning -->
  <link rel="preload" href="lib/phaser.min.js" as="script">
  <link rel="preload" href="ui/Theme.js" as="script">
  <link rel="preload" href="game/Data.js" as="script">

  <!-- ‚úÖ Preload –†–ï–ê–õ–¨–ù–´–• —à—Ä–∏—Ñ—Ç–æ–≤ -->
<link rel="preload" href="fonts/BoldPixels.woff2" as="font" type="font/woff2" crossorigin>

    <!-- ‚úÖ –§–ò–• #1: –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ —à—Ä–∏—Ñ—Ç–∞ -->
  <link rel="stylesheet" href="css/fonts.css">
  
  <!-- ‚úÖ –§–ò–• #2: Preload –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ -->
  <link rel="preload" 
        href="assets/fonts/BoldPixels.ttf" 
        as="font" 
        type="font/ttf" 
        crossorigin>



  <!-- –ú–µ–Ω–µ–¥–∂–µ—Ä –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ -->
<script src="utils/TextManager.js"></script>
  
  <!-- –î–û–ë–ê–í–õ–ï–ù–û: Favicon –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è 404 –æ—à–∏–±–∫–∏ -->
  <link rel="icon" type="image/png" href="assets/icon-32.png" sizes="32x32">
  <link rel="icon" type="image/png" href="assets/icon-16.png" sizes="16x16">
</head>
<body>
  <!-- –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –î–æ–±–∞–≤–ª–µ–Ω fallback –∫–æ–Ω—Ç–µ–Ω—Ç –≤ game div -->
  <div id="game">
    <!-- –ü—Ä–µ–ª–æ–∞–¥–µ—Ä –Ω–∞ —Å–ª—É—á–∞–π –º–µ–¥–ª–µ–Ω–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ -->
    <div id="preloader" style="
      display: flex; 
      flex-direction: column; 
      justify-content: center; 
      align-items: center; 
      height: 100vh; 
      background: #1d2330; 
      color: #fff; 
      font-family: Arial, sans-serif;
      text-align: center;
    ">
      <div style="
        width: 50px; 
        height: 50px; 
        border: 3px solid #4ECDC4; 
        border-top: 3px solid transparent; 
        border-radius: 50%; 
        animation: spin 1s linear infinite;
        margin-bottom: 20px;
      "></div>
      <h2 style="margin: 0 0 10px 0; color: #4ECDC4;">Find the Pair</h2>
      <p style="margin: 0; color: #ccc;">–ó–∞–≥—Ä—É–∑–∫–∞ –∏–≥—Ä—ã...</p>
    </div>
  </div>

  <!-- –î–û–ë–ê–í–õ–ï–ù–û: CSS –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏ –ø—Ä–µ–ª–æ–∞–¥–µ—Ä–∞ –∏ —Å—Ç–∏–ª–µ–π -->
  <style>
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    @font-face {
  font-family: 'YourFont';
  src: url('fonts/YourFont-Regular.woff2') format('woff2');
  font-weight: normal;
  font-style: normal;
  font-display: block; /* ‚Üê –í–ê–ñ–ù–û: –±–ª–æ–∫–∏—Ä—É–µ—Ç —Ä–µ–Ω–¥–µ—Ä –¥–æ –∑–∞–≥—Ä—É–∑–∫–∏ */
}
    
    /* –°–∫—Ä—ã–≤–∞–µ–º –ø—Ä–µ–ª–æ–∞–¥–µ—Ä –∫–æ–≥–¥–∞ –∏–≥—Ä–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞ */
    .game-loaded #preloader {
      display: none !important;
    }
    
    /* –£–±–µ–∂–¥–∞–µ–º—Å—è —á—Ç–æ game div –∑–∞–Ω–∏–º–∞–µ—Ç –≤–µ—Å—å —ç–∫—Ä–∞–Ω */
    #game {
      width: 100vw;
      height: 100vh;
      position: absolute;
      top: 0;
      left: 0;
      overflow: hidden;
    }
    
    /* –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ */
    body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      background: #1d2330;
    }
    
    html {
      height: 100%;
      overflow: hidden;
    }
  </style>

  <!-- –õ–æ–∫–∞–ª—å–Ω—ã–π Phaser (–≤–∞–∂–Ω–æ: –¥–æ —Å—Ü–µ–Ω) -->
  <script src="lib/phaser.min.js"></script>

  <!-- –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ/—Ç–µ–º–∞ –∏ UI (–≤–∞–∂–Ω–æ: Button.js –¥–æ —Å—Ü–µ–Ω) -->
  <script src="ui/Theme.js"></script>
  <script src="game/Data.js"></script>
  <script src="ui/Button.js"></script>

  <script src="sync/ProgressSyncManager.js"></script>

  <!-- –£–õ–£–ß–®–ï–ù–û: –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∑–∞–≥–ª—É—à–∫–∞ –¥–ª—è Button.js —Å –ø—Ä–æ–≤–µ—Ä–∫–∞–º–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π -->
  <script>
    console.log('Buttons loaded?', typeof window.makeImageButton);
    
    // –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –ü—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞–≥—Ä—É–∑–∫—É –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
    function checkDependencies() {
      const deps = {
        Phaser: typeof window.Phaser !== 'undefined',
        THEME: typeof window.THEME !== 'undefined',
        ALL_CARD_KEYS: Array.isArray(window.ALL_CARD_KEYS),
        LEVELS: Array.isArray(window.LEVELS),
        makeImageButton: typeof window.makeImageButton === 'function'
      };
      
      console.log('Dependencies check:', deps);
      
      const allLoaded = Object.values(deps).every(Boolean);
      if (allLoaded) {
        console.log('‚úÖ All dependencies loaded');
        document.body.classList.add('dependencies-ready');
      } else {
        console.warn('‚ö†Ô∏è Some dependencies missing:', 
          Object.entries(deps).filter(([key, value]) => !value).map(([key]) => key)
        );
      }
      
      return allLoaded;
    }
    
    if (typeof window.makeImageButton !== 'function') {
      console.warn('ui/Button.js –ù–ï –∑–∞–≥—Ä—É–∑–∏–ª—Å—è ‚Äî –≤–∫–ª—é—á–∞—é —É–ª—É—á—à–µ–Ω–Ω—É—é –∑–∞–≥–ª—É—à–∫—É');
      
      // –£–ª—É—á—à–µ–Ω–Ω–∞—è –∑–∞–≥–ª—É—à–∫–∞ —Å –∞–Ω–∏–º–∞—Ü–∏—è–º–∏ –∏ —Å—Ç–∏–ª—è–º–∏
      window.makeImageButton = function(scene, x, y, w, h, label, onClick, opts = {}) {
        const container = scene.add.container(x, y);
        
        // –§–æ–Ω –∫–Ω–æ–ø–∫–∏ —Å –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–º
        const bg = scene.add.graphics()
          .fillGradientStyle(0x2C3E50, 0x2C3E50, 0x34495E, 0x34495E)
          .fillRoundedRect(-w/2, -h/2, w, h, 8)
          .lineStyle(2, 0x3498DB, 0.8)
          .strokeRoundedRect(-w/2, -h/2, w, h, 8);
        
        // –¢–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏ —Å —Ç–µ–Ω—å—é
        const text = scene.add.text(0, 0, label, {
          fontFamily: window.THEME?.fontButton || 'Arial, sans-serif',
          fontSize: Math.round(h * (window.THEME?.btnFontFactor || 0.25)) + 'px',
          color: opts.color || window.THEME?.buttonTextColor || '#FFFFFF',
          fontStyle: window.THEME?.buttonStyle || 'bold'
        }).setOrigin(0.5);
        
        // –¢–µ–Ω—å –¥–ª—è —Ç–µ–∫—Å—Ç–∞
        text.setShadow(0, 2, '#000000', 4, false, true);
        
        // –ó–æ–Ω–∞ –∫–ª–∏–∫–∞
        const zone = scene.add.zone(0, 0, w, h)
          .setInteractive({ useHandCursor: true });
        
        container.add([bg, text, zone]);
        container.setSize(w, h);
        
        // –£–õ–£–ß–®–ï–ù–û: –°–æ–±—ã—Ç–∏—è —Å –∞–Ω–∏–º–∞—Ü–∏—è–º–∏
        zone.on('pointerdown', () => {
          if (onClick) {
            // –ê–Ω–∏–º–∞—Ü–∏—è –Ω–∞–∂–∞—Ç–∏—è
            scene.tweens.add({
              targets: container,
              scale: 0.95,
              duration: 100,
              yoyo: true,
              ease: 'Power2'
            });
            onClick();
          }
        });
        
        zone.on('pointerover', () => {
          // –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ñ–æ–Ω–∞ –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏
          bg.clear()
            .fillGradientStyle(0x34495E, 0x34495E, 0x3C5A78, 0x3C5A78)
            .fillRoundedRect(-w/2, -h/2, w, h, 8)
            .lineStyle(2, 0x52A7F7)
            .strokeRoundedRect(-w/2, -h/2, w, h, 8);
          
          // –ê–Ω–∏–º–∞—Ü–∏—è –º–∞—Å—à—Ç–∞–±–∞
          scene.tweens.add({ 
            targets: container, 
            scale: 1.05, 
            duration: 150,
            ease: 'Power2'
          });
        });
        
        zone.on('pointerout', () => {
          // –í–æ–∑–≤—Ä–∞—Ç –∫ –∏—Å—Ö–æ–¥–Ω–æ–º—É –≤–∏–¥—É
          bg.clear()
            .fillGradientStyle(0x2C3E50, 0x2C3E50, 0x34495E, 0x34495E)
            .fillRoundedRect(-w/2, -h/2, w, h, 8)
            .lineStyle(2, 0x3498DB, 0.8)
            .strokeRoundedRect(-w/2, -h/2, w, h, 8);
          
          scene.tweens.add({ 
            targets: container, 
            scale: 1.0, 
            duration: 150,
            ease: 'Power2'
          });
        });
        
        // –°–≤–æ–π—Å—Ç–≤–∞ –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
        container.zone = zone;
        container.label = text;
        container.bg = bg;
        return container;
      };
      
      window.makeIconButton = function(scene, x, y, size, iconText, onClick, opts = {}) {
        const container = scene.add.container(x, y);
        
        // –ö—Ä—É–≥–ª—ã–π —Ñ–æ–Ω
        const bg = scene.add.graphics()
          .fillStyle(0x2C3E50, 0.8)
          .fillCircle(0, 0, size/2)
          .lineStyle(2, 0x3498DB, 0.6)
          .strokeCircle(0, 0, size/2);
        
        // –ò–∫–æ–Ω–∫–∞
        const icon = scene.add.text(0, 0, iconText, {
          fontFamily: window.THEME?.fontButton || 'Arial, sans-serif',
          fontSize: Math.round(size * (opts.fontFactor || 0.4)) + 'px',
          color: opts.color || window.THEME?.buttonTextColor || '#FFFFFF',
          fontStyle: window.THEME?.buttonStyle || 'bold'
        }).setOrigin(0.5);
        
        // –ó–æ–Ω–∞ –∫–ª–∏–∫–∞
        const zone = scene.add.zone(0, 0, size, size)
          .setInteractive({ useHandCursor: true });
        
        container.add([bg, icon, zone]);
        container.setSize(size, size);
        
        // –°–æ–±—ã—Ç–∏—è —Å –∞–Ω–∏–º–∞—Ü–∏—è–º–∏
        zone.on('pointerdown', () => {
          if (onClick) {
            scene.tweens.add({
              targets: container,
              scale: 0.9,
              duration: 100,
              yoyo: true,
              ease: 'Power2'
            });
            onClick();
          }
        });
        
        zone.on('pointerover', () => {
          bg.clear()
            .fillStyle(0x34495E, 0.9)
            .fillCircle(0, 0, size/2)
            .lineStyle(2, 0x52A7F7)
            .strokeCircle(0, 0, size/2);
          
          scene.tweens.add({ targets: container, scale: 1.1, duration: 150 });
        });
        
        zone.on('pointerout', () => {
          bg.clear()
            .fillStyle(0x2C3E50, 0.8)
            .fillCircle(0, 0, size/2)
            .lineStyle(2, 0x3498DB, 0.6)
            .strokeCircle(0, 0, size/2);
          
          scene.tweens.add({ targets: container, scale: 1.0, duration: 150 });
        });
        
        container.zone = zone;
        container.label = icon;
        container.bg = bg;
        return container;
      };
    }
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–∞–∂–¥–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞
    setTimeout(checkDependencies, 50);
  </script>

  <!-- –°—Ü–µ–Ω—ã -->
  <script src="scenes/PreloadScene.js"></script>
  <script src="scenes/MenuScene.js"></script>
  <script src="scenes/GameScene.js"></script>

  <!-- ‚úÖ gameConfig –ø–µ—Ä–µ–Ω–µ—Å—ë–Ω –≤ main.js (–µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –ø—Ä–∞–≤–¥—ã) -->
  <script src="utils/ResponsiveManager.js"></script>

  <!-- –ò–°–ü–†–ê–í–õ–ï–ù–û: main.js –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ–¥–Ω–∏–º —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫ -->
  <script src="main.js"></script>
  
  <!-- –î–û–ë–ê–í–õ–ï–ù–û: –§–∏–Ω–∞–ª—å–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π -->
  <script>
    // –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ–≤–æ—Ä–æ—Ç–∞ —ç–∫—Ä–∞–Ω–∞
    window.addEventListener('orientationchange', () => {
      setTimeout(() => {
        if (window.game && window.game.scale) {
          window.game.scale.refresh();
          console.log('üîÑ Screen orientation changed, game refreshed');
        }
      }, 500);
    });
    
    // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞ –æ–∫–Ω–∞
    window.addEventListener('resize', () => {
      if (window.game && window.game.scale) {
        clearTimeout(window.resizeTimeout);
        window.resizeTimeout = setTimeout(() => {
          window.game.scale.refresh();
          console.log('üîÑ Window resized, game refreshed');
        }, 250);
      }
    });
    
    // –î–û–ë–ê–í–õ–ï–ù–û: –û—á–∏—Å—Ç–∫–∞ –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ —Å–æ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    window.addEventListener('beforeunload', () => {
      console.log('üîÑ Page unloading, cleaning up...');
      if (window.game) {
        try {
          window.game.destroy(true);
          window.game = null;
        } catch (e) {
          console.warn('Cleanup warning:', e);
        }
      }
    });

    // –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
    window.addEventListener('load', () => {
      console.log('üìÑ Page fully loaded');
      
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –∏–≥—Ä–∞ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–ª–∞—Å—å
      setTimeout(() => {
        if (!window.game) {
          console.warn('‚ö†Ô∏è Game not created after page load - showing error');
          const gameDiv = document.getElementById('game');
          if (gameDiv) {
            gameDiv.innerHTML = `
              <div style="
                display: flex; 
                flex-direction: column; 
                justify-content: center; 
                align-items: center; 
                height: 100vh; 
                background: #1d2330; 
                color: #fff; 
                font-family: Arial, sans-serif;
                text-align: center;
                padding: 20px;
              ">
                <h2>‚ö†Ô∏è –ò–≥—Ä–∞ –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª–∞—Å—å</h2>
                <p>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –æ–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É –∏–ª–∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ</p>
                <button onclick="location.reload()" style="
                  padding: 12px 24px; 
                  font-size: 16px; 
                  background: #e74c3c; 
                  color: white; 
                  border: none; 
                  border-radius: 8px; 
                  cursor: pointer;
                  margin-top: 20px;
                  font-weight: bold;
                ">üîÑ –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å</button>
              </div>
            `;
          }
        }
      }, 3000);
    });
  </script>


</body>
</html>
